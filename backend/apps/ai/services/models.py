from pydantic import BaseModel, Field


class ReplyOption(BaseModel):
    type: str = Field(
        ...,
        description=(
            "A free-form label describing the reply type, generated by the LLM "
            "(e.g., Positive response, Scheduling adjustment, Polite apology, etc.)."
        ),
    )
    title: str = Field(..., description="Short one-line title in target language (no quotes, no trailing punctuation)")


class ReplyPlan(BaseModel):
    language: str
    options: list[ReplyOption] = Field(..., min_length=2, max_length=4)


class ValidationResult(BaseModel):
    passed: bool = Field(..., description="True if the body passes validation")
    rewrite_instructions: str = Field("", description="Short instructions to fix issues if validation failed")


class LexicalStyle(BaseModel):
    summary: str | None
    top_connectives: str | None
    frequent_phrases: str | None
    slang_or_chat_markers: str | None
    politeness_lexemes: str | None


class GrammarPatterns(BaseModel):
    summary: str | None
    ender_distribution: str | None
    sentence_length: str | None
    sentence_type_ratio: str | None
    structure_pattern: str | None
    paragraph_stats: str | None


class EmotionalTone(BaseModel):
    summary: str | None
    overall: str | None
    formality_level: str | None
    politeness_level: str | None
    directness_score: str | None
    warmth_score: str | None
    speech_act_distribution: str | None
    request_style: str | None
    notes: str | None


class SpeechAnalysis(BaseModel):
    lexical_style: LexicalStyle | None
    grammar_patterns: GrammarPatterns | None
    emotional_tone: EmotionalTone | None
    representative_sentences: list[str] = Field(default_factory=list)


class AttachmentAnalysisResult(BaseModel):
    summary: str = Field(..., description="High-level summary of the attachment. Write 3–10 sentences depending on file length.")
    insights: str = Field(..., description="Key insights or action points extracted from the document.")
    mail_guide: str = Field(
        ..., description="Guidance on how to reference this attachment in an email — what to include in subject, introduction, and key body points."
    )
